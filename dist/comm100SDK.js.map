{"version":3,"sources":["webpack:///webpack/bootstrap ca939fa0f3af17b61a91","webpack:///./src/index.es6"],"names":["Events","eventName","toBeNotify","EVENT_PREFIX","_","notify","data","eventList","i","len","length","apply","slice","call","arguments","push","scope","startsWith","unsubscribe","notifyWith","TypeError","concat","subscribe","callback","Object","prototype","toString","splice","callbacks","guid","replace","c","r","Math","random","v","api","alive","window","parent","postMessage","action","params","msgId","console","log","Type","obj","type","_type","match","Array","String","Function","Number","Comm100AgentConsoleAPI","onReady","addEventListener","e","source","init","get","key","Promise","resolve","reject","set","value","on","do"],"mappings":"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","file":"./comm100SDK.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ca939fa0f3af17b61a91","/**\n * @module Comm100AgentConsoleAPI\n * Comm100AgentConsoleAPI AgentConsole提供的SDK库调用封装\n * @method Comm100AgentConsoleAPI\n * @author yanglang\n * @date 20170830\n */\n\nlet Events = {},\n    eventName = '',\n    toBeNotify = [],\n    EVENT_PREFIX = 'TPE'; //临时事件名称前缀，后缀为_+时间缀\n\n\nconst _ = {\n    /**\n     * 触发一个事件\n     * @method notify\n     * @param eventName 事件名称\n     * @param data 事件数据 PS：现在支持变参，除了eventName,data以外还可以添加任意参数\n     * @returns {_}\n     */\n    notify(eventName, data) {\n        var eventList = Events[eventName],\n            i = 0;\n        if (eventList) {\n            var len = eventList.length;\n            for (; i < len; i++) {\n                eventList[i].apply(this, toBeNotify.slice.call(arguments, 1));\n            }\n        } else {\n            toBeNotify.push({\n                eventName: eventName,\n                data: toBeNotify.slice.call(arguments, 1),\n                scope: this\n            }); //暂时存入待触发列表\n        }\n        //若为临时事件，则通知一次之后马上注销\n        if (eventName.startsWith(EVENT_PREFIX + '_'))\n            this.unsubscribe(eventName);\n        return this;\n    },\n    /**\n     * 给定作用域触发一个事件\n     * @param eventName 事件名称\n     * @param scope 作用域\n     * @param data 事件数据，支持变参\n     */\n    notifyWith(eventName, scope, data) {\n        if (arguments.length < 2)\n            throw new TypeError('按作用域触发事件请提供事件名称与作用域');\n        this.notify.apply(scope, [eventName].concat(toBeNotify.slice.call(arguments, 2)));\n    },\n    /**\n     * 订阅一个事件\n     * @method subscribe\n     * @param eventName 事件名称\n     * @param callback 事件回调\n     */\n    subscribe(eventName, callback) {\n        var i = 0,\n            len = toBeNotify.length;\n        if (arguments.length < 2)\n            throw new TypeError('订阅事件请提供事件名称与事件回调');\n\n        var eventList = Events[eventName] ? Events[eventName] : (Events[eventName] = []);\n        eventList = Object.prototype.toString.call(callback) === '[object Array]' ? eventList.concat(callback) : eventList.push(callback);\n        for (; i < len; i++) {\n            if (toBeNotify[i].eventName === eventName) {\n                //移除并触发之前已准备触发的事件\n                this.notify.apply(toBeNotify[i].scope, [eventName].concat(toBeNotify[i].data));\n                toBeNotify.splice(i, 1);\n                break;\n            }\n        }\n        return this;\n    },\n    /**\n     * 取消订阅事件\n     * @method unsubscribe\n     * @param eventName 事件名称\n     */\n    unsubscribe(eventName, callback) {\n        if (callback) {\n            var callbacks = Events[eventName];\n            for (var i = 0; i < callbacks.length; i++) {\n                if (callbacks[i] === callback) {\n                    callbacks.splice(i--, 1);\n                }\n            }\n        } else\n            delete Events[eventName];\n        return this;\n    },\n    guid() {\n        return 'xxxxxxxx_xxxx_4xxx_yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c)=> {\n            var r = Math.random() * 16 | 0,\n                v = c == 'x' ? r : (r & 0x3 | 0x8);\n            return v.toString(16);\n        });\n    },\n    /**\n     * 调用相关接口\n     * @method call\n     * @param api 请求地址\n     * @param data Object \n     * @param alive 非临时事件\n     */\n    call(api, data, alive) {\n        if (data.callback) {\n            eventName = !alive ? EVENT_PREFIX + '_' + this.guid() : this.guid();\n            this.subscribe(eventName, data.callback);\n        }\n        window && window.parent && window.parent.postMessage({\n            api: api,\n            action: data.action,\n            params: data.params,\n            msgId: eventName\n        }, '*'); //TODO 暂时写死* 界时改为comm100服务器地址\n\n        console.log('call', {\n            api: api,\n            action: data.action,\n            params: data.params,\n            msgId: eventName\n        })\n        return this;\n    }\n};\n\n\n\n\n/**\n * 对象类型获取\n * @method Type\n * @param obj\n * @returns {number}\n * @constructor\n */\nfunction Type(obj) {\n    var type = Object.prototype.toString.call(obj);\n    var _type = type.match(/^\\[object\\s(.*)\\]$/)[1];\n    return Type[_type] || Type.Object;\n}\nType.Object = 1;\nType.Array = 2;\nType.String = 3;\nType.Function = 4;\nType.Number = 5;\n\nconst Comm100AgentConsoleAPI = {\n    onReady(callback) {\n        window.addEventListener('message',e=>{\n            if(e.source!=window.parent) {\n                console.log('我是自己页面的消息，不予处理，返回');\n                return;\n            }\n            _.notify(e.data.msgId,e.data);\n        },false);\n        callback && callback();\n    },\n    init() {\n\n    },\n    get(key) {\n        return new Promise((resolve, reject)=> {\n            _.call(key, {\n                action: 'get',\n                callback: (data)=> {\n                    resolve(data);\n                    console.log('resolve', data);\n                }\n            });\n        });\n    },\n    set(key, value) {\n        return new Promise((resolve, reject)=> {\n            _.call(key, {\n                action: 'set',\n                params: {\n                    value: value\n                },\n                callback: (data)=> {\n                    resolve(data);\n                    console.log('resolve', data);\n                }\n            });\n        });\n    },\n    on(key, callback) {\n        _.call(key, {\n            action: 'on',\n            callback: callback\n        }, true);\n    },\n    do(key, value) {\n        return new Promise((resolve, reject) =>{\n            _.call(key, {\n                action: 'do',\n                params: {\n                    value: value\n                },\n                callback: (data)=> {\n                    resolve(data);\n                    console.log('resolve', data);\n                }\n            });\n        });\n    }\n};\n\nwindow && (window.Comm100AgentConsoleAPI = Comm100AgentConsoleAPI);\n\nexport default Comm100AgentConsoleAPI;\n\n\n// WEBPACK FOOTER //\n// ./src/index.es6"],"sourceRoot":""}