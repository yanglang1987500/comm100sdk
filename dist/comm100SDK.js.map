{"version":3,"sources":["webpack:///webpack/bootstrap db9050a66d3eabc038a8","webpack:///./src/index.es6"],"names":["Events","toBeNotify","EVENT_PREFIX","_","notify","eventName","eventList","i","rest","len","length","apply","slice","call","push","data","scope","startsWith","unsubscribe","notifyWith","arguments","TypeError","concat","subscribe","callback","Object","prototype","toString","splice","callbacks","guid","replace","c","r","Math","random","v","api","alive","messageObj","action","params","msgId","message","JSON","stringify","window","parent","postMessage","console","log","Comm100AgentConsoleAPI","onReady","addEventListener","e","source","parse","init","get","key","Promise","resolve","set","value","on","do","encodeURIComponent"],"mappings":"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","file":"./comm100SDK.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap db9050a66d3eabc038a8","/**\n * @module Comm100AgentConsoleAPI\n * Comm100AgentConsoleAPI AgentConsole\n * @method Comm100AgentConsoleAPI\n * @author yanglang\n * @date 20170830\n */\n\nconst Events = {};\nconst toBeNotify = [];\nconst EVENT_PREFIX = 'TPE';\n\n\nconst _ = {\n  /*\n   * @method notify\n   * @param eventName\n   * @returns {_}\n   */\n  notify(eventName, ...rest) {\n    const eventList = Events[eventName];\n    let i = 0;\n    if (eventList) {\n      const len = eventList.length;\n      for (; i < len; i += 1) {\n        eventList[i].apply(this, toBeNotify.slice.call(...rest, 1));\n      }\n    } else {\n      toBeNotify.push({\n        eventName,\n        data: toBeNotify.slice.call(...rest, 1),\n        scope: this,\n      });\n    }\n    if (eventName.startsWith(`${EVENT_PREFIX}_`)) { this.unsubscribe(eventName); }\n    return this;\n  },\n  /*\n   * @param eventName\n   * @param scope\n   * @param data\n   */\n  notifyWith(eventName, scope, ...rest) {\n    if (arguments.length < 2) { throw new TypeError('arguments error'); }\n    this.notify.apply(scope, [eventName].concat(toBeNotify.slice.call(...rest, 2)));\n  },\n  /*\n   * @method subscribe\n   * @param eventName\n   * @param callback\n   */\n  subscribe(eventName, callback) {\n    let i = 0;\n    const len = toBeNotify.length;\n    if (arguments.length < 2) { throw new TypeError('arguments error '); }\n\n    let eventList = Events[eventName] ? Events[eventName] : (Events[eventName] = []);\n    if (Object.prototype.toString.call(callback) === '[object Array]') {\n      eventList = eventList.concat(callback);\n    } else {\n      eventList.push(callback);\n    }\n    for (; i < len; i += 1) {\n      if (toBeNotify[i].eventName === eventName) {\n        this.notify.apply(toBeNotify[i].scope, [eventName].concat(toBeNotify[i].data));\n        toBeNotify.splice(i, 1);\n        break;\n      }\n    }\n    return this;\n  },\n  /*\n   * @method unsubscribe\n   * @param eventName\n   */\n  unsubscribe(eventName, callback) {\n    if (callback) {\n      const callbacks = Events[eventName];\n      for (let i = 0; i < callbacks.length; i += 1) {\n        if (callbacks[i] === callback) {\n          callbacks.splice(i -= 1, 1);\n        }\n      }\n    } else { delete Events[eventName]; }\n    return this;\n  },\n  guid() {\n    return 'xxxxxxxx_xxxx_4xxx_yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n      /* eslint-disable */\n      const r = Math.random() * 16 | 0;\n      const v = c === 'x' ? r : (r & 0x3 | 0x8);\n      /* eslint-enable */\n      return v.toString(16);\n    });\n  },\n  /*\n   * @method call\n   * @param api\n   * @param data Object\n   * @param alive\n   */\n  call(api, data, alive) {\n    let eventName = '';\n    if (data.callback) {\n      eventName = !alive ? `${EVENT_PREFIX}_${this.guid()}` : api;\n      this.subscribe(eventName, data.callback);\n    }\n    const messageObj = {\n      api,\n      action: data.action,\n      params: data.params,\n      msgId: eventName,\n    };\n    const message = JSON.stringify(messageObj);\n\n    if (typeof window !== 'undefined') {\n      if (typeof window.parent !== 'undefined') {\n        window.parent.postMessage(message, '*');\n      }\n    }\n\n    console.log('call', message);\n    return this;\n  },\n};\n\n\nconst Comm100AgentConsoleAPI = {\n  onReady(callback) {\n    window.addEventListener('message', (e) => {\n      if (e.source !== window.parent) {\n        console.log('from self return');\n        return;\n      }\n      const data = JSON.parse(e.data);\n      _.notify(data.msgId || data.api, data);\n    }, false);\n    if (callback) {\n      callback();\n    }\n  },\n  init() {\n\n  },\n  get(key) {\n    return new Promise((resolve) => {\n      _.call(key, {\n        action: 'get',\n        callback: (data) => {\n          resolve(data);\n          console.log('resolve', data);\n        },\n      });\n    });\n  },\n  set(key, value) {\n    return new Promise((resolve) => {\n      _.call(key, {\n        action: 'set',\n        params: {\n          value,\n        },\n        callback: (data) => {\n          resolve(data);\n          console.log('resolve', data);\n        },\n      });\n    });\n  },\n  on(key, callback) {\n    _.call(key, {\n      action: 'on',\n      callback,\n    }, true);\n  },\n  do(key, value) {\n    return new Promise((resolve) => {\n      _.call(key, {\n        action: 'do',\n        params: {\n          value: encodeURIComponent(value),\n        },\n        callback: (data) => {\n          resolve(data);\n          console.log('resolve', data);\n        },\n      });\n    });\n  },\n};\n\nif (typeof window !== 'undefined') {\n  window.Comm100AgentConsoleAPI = Comm100AgentConsoleAPI;\n}\n\nexport default Comm100AgentConsoleAPI;\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.es6"],"sourceRoot":""}