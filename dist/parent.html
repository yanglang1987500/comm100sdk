<html>
	<head>
		<script type="text/javascript">
        var flag = false;
			window.addEventListener('message',function(e){
                var data = JSON.parse(e.data);
                console.log(data);
                switch(data.action){
                	case 'get':
                	case 'set':
                	case 'do':
                		data.params = {result:'我是结果'};
                		var message = JSON.stringify(data);
                		document.getElementById('frame').contentWindow.postMessage(message,'*');
                		break;
                	case 'on':
                        if(flag)
                            return;
                        (function(msgId){
                            setInterval(function(){
                                var message = JSON.stringify({
                                    msgId:msgId,
                                    result:'on的通知'
                                });
                                document.getElementById('frame').contentWindow.postMessage(message,'*');
                            },2000)
                        })(data.msgId);
                        flag = true;
                		break;
                		
                }
                
            },false);
		</script>
	</head>
	<body>
		<iframe id='frame' height="100%" width="100%" src="./son.html" frameborder="0"></iframe>
	</body>
</html>